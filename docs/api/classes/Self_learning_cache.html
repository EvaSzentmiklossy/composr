<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
<meta charset="utf-8">
<title>
            Composr API documentation
        </title>
<meta name="author" content="Mike van Riel">
<meta name="description" content="">
<link href="../css/template.css" rel="stylesheet" media="all">
<script src="../js/jquery-1.7.1.min.js" type="text/javascript"></script><script src="../js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script><script src="../js/jquery.mousewheel.min.js" type="text/javascript"></script><script src="../js/bootstrap.js" type="text/javascript"></script><script src="../js/template.js" type="text/javascript"></script><script src="../js/prettify/prettify.min.js" type="text/javascript"></script><link rel="shortcut icon" href="../img/favicon.ico">
<link rel="apple-touch-icon" href="../img/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="72x72" href="../img/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="114x114" href="../img/apple-touch-icon-114x114.png">
</head>
<body>
<div class="navbar navbar-fixed-top">
<div class="navbar-inner"><div class="container">
<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href="../index.html">
                        Composr API documentation
                    </a><div class="nav-collapse"><ul class="nav">
<li class="dropdown">
<a href="#api" class="dropdown-toggle" data-toggle="dropdown">
                                    API Documentation <b class="caret"></b></a><ul class="dropdown-menu">
<li><a>Packages</a></li>
<li><a href="../packages/aggregate_types.html"><i class="icon-folder-open"></i> aggregate_types</a></li>
<li><a href="../packages/authors.html"><i class="icon-folder-open"></i> authors</a></li>
<li><a href="../packages/awards.html"><i class="icon-folder-open"></i> awards</a></li>
<li><a href="../packages/backup.html"><i class="icon-folder-open"></i> backup</a></li>
<li><a href="../packages/banners.html"><i class="icon-folder-open"></i> banners</a></li>
<li><a href="../packages/bookmarks.html"><i class="icon-folder-open"></i> bookmarks</a></li>
<li><a href="../packages/breadcrumbs.html"><i class="icon-folder-open"></i> breadcrumbs</a></li>
<li><a href="../packages/calendar.html"><i class="icon-folder-open"></i> calendar</a></li>
<li><a href="../packages/captcha.html"><i class="icon-folder-open"></i> captcha</a></li>
<li><a href="../packages/catalogues.html"><i class="icon-folder-open"></i> catalogues</a></li>
<li><a href="../packages/chat.html"><i class="icon-folder-open"></i> chat</a></li>
<li><a href="../packages/cns_forum.html"><i class="icon-folder-open"></i> cns_forum</a></li>
<li><a href="../packages/commandr.html"><i class="icon-folder-open"></i> commandr</a></li>
<li><a href="../packages/content_privacy.html"><i class="icon-folder-open"></i> content_privacy</a></li>
<li><a href="../packages/content_reviews.html"><i class="icon-folder-open"></i> content_reviews</a></li>
<li><a href="../packages/core.html"><i class="icon-folder-open"></i> core</a></li>
<li><a href="../packages/core_abstract_interfaces.html"><i class="icon-folder-open"></i> core_abstract_interfaces</a></li>
<li><a href="../packages/core_addon_management.html"><i class="icon-folder-open"></i> core_addon_management</a></li>
<li><a href="../packages/core_cns.html"><i class="icon-folder-open"></i> core_cns</a></li>
<li><a href="../packages/core_database_drivers.html"><i class="icon-folder-open"></i> core_database_drivers</a></li>
<li><a href="../packages/core_feedback_features.html"><i class="icon-folder-open"></i> core_feedback_features</a></li>
<li><a href="../packages/core_fields.html"><i class="icon-folder-open"></i> core_fields</a></li>
<li><a href="../packages/core_form_interfaces.html"><i class="icon-folder-open"></i> core_form_interfaces</a></li>
<li><a href="../packages/core_forum_drivers.html"><i class="icon-folder-open"></i> core_forum_drivers</a></li>
<li><a href="../packages/core_language_editing.html"><i class="icon-folder-open"></i> core_language_editing</a></li>
<li><a href="../packages/core_menus.html"><i class="icon-folder-open"></i> core_menus</a></li>
<li><a href="../packages/core_notifications.html"><i class="icon-folder-open"></i> core_notifications</a></li>
<li><a href="../packages/core_rich_media.html"><i class="icon-folder-open"></i> core_rich_media</a></li>
<li><a href="../packages/core_themeing.html"><i class="icon-folder-open"></i> core_themeing</a></li>
<li><a href="../packages/core_upgrader.html"><i class="icon-folder-open"></i> core_upgrader</a></li>
<li><a href="../packages/core_webstandards.html"><i class="icon-folder-open"></i> core_webstandards</a></li>
<li><a href="../packages/custom_comcode.html"><i class="icon-folder-open"></i> custom_comcode</a></li>
<li><a href="../packages/downloads.html"><i class="icon-folder-open"></i> downloads</a></li>
<li><a href="../packages/ecommerce.html"><i class="icon-folder-open"></i> ecommerce</a></li>
<li><a href="../packages/filedump.html"><i class="icon-folder-open"></i> filedump</a></li>
<li><a href="../packages/galleries.html"><i class="icon-folder-open"></i> galleries</a></li>
<li><a href="../packages/google_appengine.html"><i class="icon-folder-open"></i> google_appengine</a></li>
<li><a href="../packages/import.html"><i class="icon-folder-open"></i> import</a></li>
<li><a href="../packages/ldap.html"><i class="icon-folder-open"></i> ldap</a></li>
<li><a href="../packages/msn.html"><i class="icon-folder-open"></i> msn</a></li>
<li><a href="../packages/news.html"><i class="icon-folder-open"></i> news</a></li>
<li><a href="../packages/newsletter.html"><i class="icon-folder-open"></i> newsletter</a></li>
<li><a href="../packages/points.html"><i class="icon-folder-open"></i> points</a></li>
<li><a href="../packages/pointstore.html"><i class="icon-folder-open"></i> pointstore</a></li>
<li><a href="../packages/polls.html"><i class="icon-folder-open"></i> polls</a></li>
<li><a href="../packages/quizzes.html"><i class="icon-folder-open"></i> quizzes</a></li>
<li><a href="../packages/realtime_rain.html"><i class="icon-folder-open"></i> realtime_rain</a></li>
<li><a href="../packages/recommend.html"><i class="icon-folder-open"></i> recommend</a></li>
<li><a href="../packages/search.html"><i class="icon-folder-open"></i> search</a></li>
<li><a href="../packages/securitylogging.html"><i class="icon-folder-open"></i> securitylogging</a></li>
<li><a href="../packages/shopping.html"><i class="icon-folder-open"></i> shopping</a></li>
<li><a href="../packages/sms.html"><i class="icon-folder-open"></i> sms</a></li>
<li><a href="../packages/stats.html"><i class="icon-folder-open"></i> stats</a></li>
<li><a href="../packages/syndication.html"><i class="icon-folder-open"></i> syndication</a></li>
<li><a href="../packages/themewizard.html"><i class="icon-folder-open"></i> themewizard</a></li>
<li><a href="../packages/tickets.html"><i class="icon-folder-open"></i> tickets</a></li>
<li><a href="../packages/wiki.html"><i class="icon-folder-open"></i> wiki</a></li>
</ul>
</li>
<li class="dropdown" id="charts-menu">
<a href="#charts" class="dropdown-toggle" data-toggle="dropdown">
                                    Charts <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="../graph_class.html"><i class="icon-list-alt"></i> Class hierarchy diagram</a></li></ul>
</li>
<li class="dropdown" id="reports-menu">
<a href="#reports" class="dropdown-toggle" data-toggle="dropdown">
                                    Reports <b class="caret"></b></a><ul class="dropdown-menu">
<li><a href="../errors.html"><i class="icon-remove-sign"></i> Errors 
                <span class="label label-info">499</span></a></li>
<li><a href="../markers.html"><i class="icon-map-marker"></i> Markers 
                <ul></ul></a></li>
<li><a href="../deprecated.html"><i class="icon-stop"></i> Deprecated elements 
                <span class="label label-info">0</span></a></li>
</ul>
</li>
</ul></div>
</div></div>
<div class="go_to_top"><a href="#___" style="color: inherit">Back to top  <i class="icon-upload icon-white"></i></a></div>
</div>
<div id="___" class="container">
<noscript><div class="alert alert-warning">
                            Javascript is disabled; several features are only available
                            if Javascript is enabled.
                        </div></noscript>
<div class="row">
<div class="span4">
<div xmlns:php="http://php.net/xsl" class="btn-toolbar">
<div class="btn-group visibility" data-toggle="buttons-checkbox">
<button class="btn public active" title="Show public elements">Public</button><button class="btn protected" title="Show protected elements">Protected</button><button class="btn private" title="Show private elements">Private</button><button class="btn inherited active" title="Show inherited elements">Inherited</button>
</div>
<div class="btn-group view pull-right" data-toggle="buttons-radio">
<button class="btn details" title="Show descriptions and method names"><i class="icon-list"></i></button><button class="btn simple" title="Show only method names"><i class="icon-align-justify"></i></button>
</div>
</div>
<ul xmlns:php="http://php.net/xsl" class="side-nav nav nav-list">
<li class="nav-header">
<i title="Methods" class="icon-custom icon-method"></i> Methods
                    <ul>
<li class="method public "><a href="#method___construct" title="__construct() :: Constructor. Initialise our cache."><span class="description">Constructor. Initialise our cache.</span><pre>__construct()</pre></a></li>
<li class="method public "><a href="#method_append" title="append() :: Add something to a list entry in the cache. Uses keys to set the value, then assigns $value_2 to the key."><span class="description">Add something to a list entry in the cache. Uses keys to set the value, then assigns $value_2 to the key.</span><pre>append()</pre></a></li>
<li class="method public "><a href="#method_erase_smart_cache" title="erase_smart_cache() :: Called by various other erase_* functions that know the smart cache may be involved."><span class="description">Called by various other erase_* functions that know the smart cache may be involved.</span><pre>erase_smart_cache()</pre></a></li>
<li class="method public "><a href="#method_get" title="get() :: Get a cache key."><span class="description">Get a cache key.</span><pre>get()</pre></a></li>
<li class="method public "><a href="#method_get_initial_status" title="get_initial_status() :: See if a cache key was initially set."><span class="description">See if a cache key was initially set.</span><pre>get_initial_status()</pre></a></li>
<li class="method public "><a href="#method_invalidate" title="invalidate() :: Invalidate the cache, so that it will rebuild."><span class="description">Invalidate the cache, so that it will rebuild.</span><pre>invalidate()</pre></a></li>
<li class="method public "><a href="#method_is_on" title="is_on() :: Find whether the smart cache is on."><span class="description">Find whether the smart cache is on.</span><pre>is_on()</pre></a></li>
<li class="method public "><a href="#method_set" title="set() :: Set a cache key."><span class="description">Set a cache key.</span><pre>set()</pre></a></li>
</ul>
</li>
<li class="nav-header private">» Private
                    <ul>
<li class="method private "><a href="#method_load" title="load() :: Load the cache for the particular bucket this cache object is for."><span class="description">Load the cache for the particular bucket this cache object is for.</span><pre>load()</pre></a></li>
<li class="method private "><a href="#method_save" title="save() :: Save the cache, after some change has happened."><span class="description">Save the cache, after some change has happened.</span><pre>save()</pre></a></li>
</ul>
</li>
<li class="nav-header">
<i title="Properties" class="icon-custom icon-property"></i> Properties
                    <ul></ul>
</li>
<li class="nav-header private">» Private
                    <ul>
<li class="property private "><a href="#property_bucket_name" title="$bucket_name() :: "><span class="description"></span><pre>$bucket_name</pre></a></li>
<li class="property private "><a href="#property_data" title="$data() :: "><span class="description"></span><pre>$data</pre></a></li>
<li class="property private "><a href="#property_keys_inital" title="$keys_inital() :: "><span class="description"></span><pre>$keys_inital</pre></a></li>
<li class="property private "><a href="#property_path" title="$path() :: "><span class="description"></span><pre>$path</pre></a></li>
<li class="property private "><a href="#property_pending_save" title="$pending_save() :: "><span class="description"></span><pre>$pending_save</pre></a></li>
</ul>
</li>
</ul>
</div>
<div class="span8">
<a xmlns:php="http://php.net/xsl" id="\Self_learning_cache"></a><ul xmlns:php="http://php.net/xsl" class="breadcrumb">
<li>
<a href="../index.html"><i title="Classes" class="icon-custom icon-class"></i></a><span class="divider">\</span>
</li>
<li class="active">
<span class="divider">\</span><a href="../classes/Self_learning_cache.html">Self_learning_cache</a>
</li>
</ul>
<div xmlns:php="http://php.net/xsl" class="element class">
<p class="short_description">The self-learning cache is an adaptive per-page/script cache, which loads from disk in a single efficient operation.</p>
<div class="details">
<div class="long_description"><p>If something will not 'get' then the expectation is that a more costly &quot;full load&quot; or &quot;upfront work&quot; operation will be performed, but
a 'set' will also happen so on next script load this won't be needed (at least, eventually, after things settle down across different access patterns).</p>
<p>The cache size is minimised, only required resources by the particular per-page/script are put there.
Typically cache entries will be very small and voluminous, but predictable,
hence why we don't just use individual fetches on a conventional cache layer.
It is a disk vs CPU tradeoff. The intent is to approach performance as if each page/script were hand-coded to know its exact dependencies.</p>
<p>Some usage notes:
Cached items should not be too volatile, although the cache is clever enough to not re-save if no real changes actually resulted from set/append operations;
in other words the cache should quickly stabilise and not keep having to do writes
You should not use this as an alternative to the persistent cache for caching everything that the persistent cache can already do;
although sometimes it is good to do special batching operations (e.g. avoid repeating query patterns) that would already be separately optimised when the persistent cache was on
We cannot always put cache stuff direct into smart cache as it may vary per-usergroup for example;
anything in the cache really should be useful for all page loads, we do not want to have to load a great bloated smart cache on each page load;
the above said, we will often <em>say</em> what is needed, then feed this in for doing bulk loads from the dedicated caches (e.g. saying which blocks to bulk load)</p></div>
<table class="table table-bordered"><tr>
<th>package</th>
<td><a href="../packages/core.html">core</a></td>
</tr></table>
<h3>
<i title="Methods" class="icon-custom icon-method"></i> Methods</h3>
<a id="method___construct"></a><div class="element clickable method public method___construct " data-toggle="collapse" data-target=".method___construct .collapse" title="public">
<h2>Constructor. Initialise our cache.</h2>
<pre>__construct(\ID_TEXT $bucket_name) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$bucket_name</h4>
<code>\ID_TEXT</code><p>The identifier this cache object is for</p></div>
</div></div>
</div>
<a id="method_append"></a><div class="element clickable method public method_append " data-toggle="collapse" data-target=".method_append .collapse" title="public">
<h2>Add something to a list entry in the cache. Uses keys to set the value, then assigns $value_2 to the key.</h2>
<pre>append(\ID_TEXT $key, mixed $value, mixed $value_2<code> = true</code>) : boolean</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"><p>This is efficient for duplication prevention.</p></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$key</h4>
<code>\ID_TEXT</code><p>Cache key</p></div>
<div class="subelement argument">
<h4>$value</h4>
<code>mixed</code><p>Value to append (must not be an object or array, so you may need to pre-serialize)</p></div>
<div class="subelement argument">
<h4>$value_2</h4>
<code>mixed</code><p>Secondary value to attach to appended value (optional)</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>boolean</code>Whether the value was appended (false if it was already there)</div>
</div></div>
</div>
<a id="method_erase_smart_cache"></a><div class="element clickable method public method_erase_smart_cache " data-toggle="collapse" data-target=".method_erase_smart_cache .collapse" title="public">
<h2>Called by various other erase_* functions that know the smart cache may be involved.</h2>
<pre>erase_smart_cache() </pre>
<div class="labels"><span class="label">Static</span></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method_get"></a><div class="element clickable method public method_get " data-toggle="collapse" data-target=".method_get .collapse" title="public">
<h2>Get a cache key.</h2>
<pre>get(\ID_TEXT $key) : \?mixed</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$key</h4>
<code>\ID_TEXT</code><p>Cache key</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>\?mixed</code>The value (null: not in cache - needs to be learnt)</div>
</div></div>
</div>
<a id="method_get_initial_status"></a><div class="element clickable method public method_get_initial_status " data-toggle="collapse" data-target=".method_get_initial_status .collapse" title="public">
<h2>See if a cache key was initially set.</h2>
<pre>get_initial_status(\ID_TEXT $key) : boolean</pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$key</h4>
<code>\ID_TEXT</code><p>Cache key</p></div>
<h3>Returns</h3>
<div class="subelement response">
<code>boolean</code>Whether it was</div>
</div></div>
</div>
<a id="method_invalidate"></a><div class="element clickable method public method_invalidate " data-toggle="collapse" data-target=".method_invalidate .collapse" title="public">
<h2>Invalidate the cache, so that it will rebuild.</h2>
<pre>invalidate() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method_is_on"></a><div class="element clickable method public method_is_on " data-toggle="collapse" data-target=".method_is_on .collapse" title="public">
<h2>Find whether the smart cache is on.</h2>
<pre>is_on() : boolean</pre>
<div class="labels"><span class="label">Static</span></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Returns</h3>
<div class="subelement response">
<code>boolean</code>Whether it is</div>
</div></div>
</div>
<a id="method_set"></a><div class="element clickable method public method_set " data-toggle="collapse" data-target=".method_set .collapse" title="public">
<h2>Set a cache key.</h2>
<pre>set(\ID_TEXT $key, mixed $value) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$key</h4>
<code>\ID_TEXT</code><p>Cache key</p></div>
<div class="subelement argument">
<h4>$value</h4>
<code>mixed</code><p>Value. Should not be null, as that is reserved for "not in cache"</p></div>
</div></div>
</div>
<a id="method_load"></a><div class="element clickable method private method_load " data-toggle="collapse" data-target=".method_load .collapse" title="private">
<h2>Load the cache for the particular bucket this cache object is for.</h2>
<pre>load() </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="method_save"></a><div class="element clickable method private method_save " data-toggle="collapse" data-target=".method_save .collapse" title="private">
<h2>Save the cache, after some change has happened.</h2>
<pre>save(boolean $do_immediately<code> = false</code>) </pre>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description">
<div class="long_description"></div>
<h3>Parameters</h3>
<div class="subelement argument">
<h4>$do_immediately</h4>
<code>boolean</code><p>Immediately save the cache change (slow...)</p></div>
</div></div>
</div>
<h3>
<i title="Properties" class="icon-custom icon-property"></i> Properties</h3>
<a id="property_bucket_name"> </a><div class="element clickable property private property_bucket_name" data-toggle="collapse" data-target=".property_bucket_name .collapse" title="private">
<h2>$bucket_name</h2>
<pre>$bucket_name </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>null</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_data"> </a><div class="element clickable property private property_data" data-toggle="collapse" data-target=".property_data .collapse" title="private">
<h2>$data</h2>
<pre>$data </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>null</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_keys_inital"> </a><div class="element clickable property private property_keys_inital" data-toggle="collapse" data-target=".property_keys_inital .collapse" title="private">
<h2>$keys_inital</h2>
<pre>$keys_inital </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>array()</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_path"> </a><div class="element clickable property private property_path" data-toggle="collapse" data-target=".property_path .collapse" title="private">
<h2>$path</h2>
<pre>$path </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>null</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
<a id="property_pending_save"> </a><div class="element clickable property private property_pending_save" data-toggle="collapse" data-target=".property_pending_save .collapse" title="private">
<h2>$pending_save</h2>
<pre>$pending_save </pre>
<div class="row collapse"><div class="detail-description">
<h3>Default</h3>
<div class="subelement argument"><code>false</code></div>
</div></div>
<div class="labels"></div>
<div class="row collapse"><div class="detail-description"><div class="long_description"></div></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="row"><footer class="span12">
            Template is built using <a href="http://twitter.github.com/bootstrap/">Twitter Bootstrap 2</a> and icons provided by <a href="http://glyphicons.com/">Glyphicons</a>.<br>
            Documentation is powered by <a href="http://www.phpdoc.org/">phpDocumentor 2.8.5</a> and<br>
            generated on 2015-09-04T16:29:45+01:00.<br></footer></div>
</div>
</body>
</html>
