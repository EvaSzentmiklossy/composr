[title sub="Written by Chris Graham (ocProducts)"]Composr Tutorial: Creating sub-communities (and sub-sites)[/title]

Composr is designed to be able to support large community sites, and a common features of the largest sites is to have sub-communities within the larger community. There are a number of features in Composr to support this, including:
 - [b]Zones[/b] (different zones may be created for each sub-community, located under a URL beneath the main site, with their own set of pages)
 - [b]Redirection pages[/b] (using redirection pages, common modules, such as the download module, may be made to appear as if they are running from individual zones)
 - [b]Categories, and virtual roots[/b] (using a combination of separate categories [and sub-branches there-of] for different sub-communities, and the 'virtual root' system, it can be made to appear that each sub-community has their own catalogue/download/gallery
 - [b]Comcode pages, Chatrooms, Polls[/b] (all these support individual creating and referencing, such that different instances can be presented to different sub-communities)
 - [b]Banners, Calendar[/b] (all these support category based referencing such that a division between sub-community interests can be created)
 - [b]Sub-forums[/b] (different communities can be given their own branch of the discussion forums, with the [concept]Conversr[/concept] 'Clubs' feature providing special support for this)
 - [b]Themes[/b] (different themes may be applied to different zones, giving sub-communities individual looks)
 - [b]Usergroups and access privileges[/b] (members of sub-communities may be grouped by usergroup, and permissions assigned accordingly)
 - [b]Custom profile fields[/b] [[concept]Conversr[/concept] users only] (custom profile fields can be made so that they only apply to a single usergroup: thus allowing specification of user data that applies only to specific sub-communities)
 - [i]More advanced techniques discussed in "Advanced techniques for multi-site-networks"[/i]

[contents]decimal,lower-alpha[/contents]

[title="2"]Multi-Site-Networks[/title]

For some sites, it is advantageous to be able to create a whole website for each sub-community, each with its own settings, yet sharing a single member database and forums. This is possible using a Composr configuration known as a 'multi-site-network' and essentially involves separate Composr installs that are tied together by sharing a forum database. Composr provides special features for multi-site-network sites, and there is separate tutorial on them: as they involve separate installs, most of the features described in this tutorial are not necessary.

Advantages to using a multi-site network:
 - Full control
 - Cleaner administrative separation
 - Special multi-site-network features, such as the 'netlink' system

Disadvantages to using a multi-site network:
 - Overhead of additional configuration and maintenance

[title="2"]Zones[/title]

[surround]
[media width="150" description="To finalise the zone, FTP details may be needed so Composr can create the directory structure properly -- depending on server architecture" float="right"]data_custom/images/docs/tut_subcom/subcom_zone_afm.png[/media]
[media width="150" description="Adding a new zone for our Church Of Santa subcommunity" float="right"]data_custom/images/docs/tut_subcom/subcom_zone_add.png[/media]
An introduction to zones is covered in the [page="_SEARCH:tut_structure"]Composr site structure tutorial[/page].

You may add new zones, edit zones, delete zones, and move pages between zones from Admin Zone > Structure > Zones.
You can delete a zone from the bottom of its edit form.

When performing an action that will add, rename or delete a zone, you may need to provide details that tell Composr how it can do this; this is because on the some web hosting configurations, PHP does not have full access to files on the hosting account (lack of suEXEC). These details are the same as you provided when using the Composr quick installer (assuming you used this to install).

[title="3"]Zone logos (advanced)[/title]

To change the logo image for a zone, add a theme image named [tt]<zone-name>-logo[/tt]. By default zones use the logo image of the Welcome Zone.
[/surround]

[title="2"]Redirection pages[/title]

[surround]
[media width="150" description="Managing redirection pages" float="right"]data_custom/images/docs/tut_subcom/subcom_redirects.png[/media]
{!redirects:DOC_REDIRECTS}

Redirections are useful for a number of reasons, including:
 - Sharing modules between zones
 - Making short-cuts to zone/page combinations
 - Making it so obvious URL mistakes can be automatically corrected
 - When moving pages, a redirect may be placed so that links are not broken

To reach the Redirects module go to Admin Zone > Structure > Redirects.

[box="Special tip"]
If you want a module to behave as if it was completely moved, you can set up a transparent redirect from your desired location to the actual location, and then a non-transparent redirect from the actual location to the desired location. Composr will sense your intent, so when you do something that searches for that module (e.g. for the Wiki+ module, doing a Wiki+ link) it will go to where you want. For example, if you wanted to move the [tt]supermembers[/tt] module from the Collaboration Zone to the Site zone, you could set up these redirects: [tt]site:supermembers[/tt]-->[tt]collaboration:supermembers[/tt] [i]transparent[/i] [b]and[/b] [tt]collaboration:supermembers[/tt]-->[tt]site:supermembers[/tt] [i]non-transparent[/i]. Composr will see the transparent redirect as an indication the super-members module really has a proper home in the site zone, and it will see the non-transparent redirect as an indication the super-members module really does not have a proper home in the collaboration zone; Composr will respect these indications and link to the module in its new home.
[/box]
[/surround]

[title="2"]Virtual roots[/title]

[surround]
[media width="150" description="The virtualed download category" float="right"]data_custom/images/docs/tut_subcom/subcom_virtualed.png[/media]
[media width="150" description="Viewing the download category we added, we can find the virtualisation URL" float="right"]data_custom/images/docs/tut_subcom/subcom_cat_view.png[/media]
[media width="150" description="Adding a download category for the NewTown Parish subcommunity" float="right"]data_custom/images/docs/tut_subcom/subcom_cat_add.png[/media]
A number of Composr modules contain categories organised into a tree structure, including:
 - galleries
 - download categories
 - catalogue categories

If sub-community categories are stored under a common sub-tree of the full category tree, then the root of the 'sub-tree' may be made into the apparent root of the full-tree, by picking it as a virtual-root. This is easy to do, and doesn't involve any kind of configuration other than finding the URL to enter the module with. To find this URL you just look for the link of the current category in the breadcrumbs on a category screen (it'll have something similar to [tt]keep_root[/tt] in it): this is a mouthful to explain, but really very simple. Once you have the URL, you may wish to add it to to the menu of your sub-communities zone.

Here are some step-by-step instructions:
1) Browse into the forum you'd like to be the virtual root. You need to be logged in as a staff member when you do this
2) Look at the breadcrumbs. You should see the final (rightmost) link in the chain is also a link. This might appear strange, because you're already on the page so why would a link be shown? The reason is that it is an anchor to let you create a virtual root link
3) Click the link
4) You should see now you have set a virtual root
5) Take the URL you're at and put it on your menus as required
[/surround]

[title="2"]Usergroup management[/title]

[media width="150" description="Managing a usergroup" float="right"]data_custom/images/docs/tut_subcom/usergroup.png[/media]
The [concept]Conversr[/concept] system has a powerful usergroup system.

{!cns:DOC_GROUPS}

[title="3"]Ranks[/title]

Members will be able to automatically enter usergroups on their rank ladder as they accumulate points.
Their visible rank, and privileges change in accordance.

Rank ladders are not formally codified. A member can be considered on a rank ladder if they are on a usergroup with any particular promotion path. Members may be on multiple ladders by being in multiple promotable usergroups. Usually a site will only have on rank ladder though.

There is a default rank ladder that goes:
Newbie --> Regular --> Local --> Old timer --> Local hero

It is recommended that you leave all non-staff members such that their primary usergroup stays within this rank ladder, and use secondary usergroups for the purpose of placing them in sub-communities, and granting additional permissions (a member has the 'best' permission combination out of all the permissions granted to all of their usergroups). This keeps things consistent, allowing these members to have both your main rank and other usergroup memberships.

You can attach your choice of rank image to any usergroup.

The Setup Wizard has an option to remove the default rank ladder and have a simple 'Members' usergroup instead.

[title="3"]New member status[/title]

When members join they are placed, by default, in the 'Newbie' or 'Members' usergroup.

Conversr allows you to choose which secondary usergroups a member is placed in when they join.

Setting of default usergroups allows you to give people permission "by default", but to take it away if they abuse it without having to put them onto a different rank ladder. For example, a 'debates' forum could be created and only the 'Civil Debater' usergroup given access; the 'Civil Debater' usergroup could be a default usergroup, meaning all have access by default -- however, members who demonstrated an inability to debate in a civil manner could be removed from it.

It is also possible to give members a choice from a number of primary usergroups when they join. This is especially useful for what I call 'role-based communities', where different members use the website in such a way that is distinct to their role on it. By assigning usergroup according to role, it is possible to use various Composr features in order to customise the site for each role provided.

You'll find all these options on the add/edit usergroup form.

[title="3"]Back-end[/title]

Manage usergroups from Admin Zone > Security > Usergroups.
You can delete a usergroup from the bottom of its edit form -- except you cannot delete certain default usergroups that are used for system functions or as fail-safes.

There is also a module for putting members into usergroups temporarily:
Admin Zone > Security > Temporary usergroup memberships

[title="3"]Front-end, and leadership[/title]

[surround]
[media width="150" description="Adding a new usergroup" float="right"]data_custom/images/docs/tut_subcom/usergroup_add.png[/media]
[media width="150" description="The usergroup directory" float="right"]data_custom/images/docs/tut_subcom/usergroup_directory.png[/media]
Usergroups can be browsed via the Usergroup Directory, which is part of the groups module ([tt]site:groups[/tt] page-link, Social > Usergroups on the default menus). The usergroup directory lists all non-hidden usergroups in a clear and tidy way.

You may opt to assign a leader to usergroups, or to leave them leaderless. A usergroup leader has the ability to control who is in their usergroup (secondary membership only), taking pressure away from the staff. Otherwise, only administrators may add users to usergroups (this is not done using privileges, as it would grant the ability for any member with such as privilege to escalate themselves to administrator status).

When a member views a usergroup they have the following possible interactions:
 - [i]If they are not already a member:[/i]
  - [i]If "Open membership") has been enabled:[/i]
   - Join as secondary
  - [i]Otherwise:[/i]
   - Apply to join as secondary (become a prospective member)
 - [i]Otherwise:[/i]
  - [i]If they are a secondary member:[/i]
   - Leave
 - [i]If they have usergroup leadership access:[/i]
  - Add members as secondary
  - Remove secondary members
  - Accept prospective members
  - Decline prospective members

When a usergroup application is made a notification is dispatched to the leader of the usergroup, or to the staff if there is no leader.

[title="3"]Clubs[/title]

The [concept]Conversr[/concept] system provides a clubs feature (Content Management > Clubs). Clubs are special usergroups:
 - that can not have special permissions (they are not shown in permission editing interfaces)
 - that may be joined and left like ordinary usergroups (via secondary usergroup membership)
 - that come with their own forum (privileges to this are automatically assigned when the club and forum are created and cannot be revoked through the Composr permission editing interfaces)
 - may be added by ordinary members
Clubs are provided so that members may create their own sub-communities on the website. They are not given any special permissions so as to not overcomplicate the regular permission configuration process (as potentially you might have hundreds or even thousands of clubs).

The club forum has default permissions that only allow website staff and club members into it. The club functionality provides no special moderation controls -- so by default the forum would need to be moderated by the website staff, rather than self-moderated. As it is a regular forum, additional permission changes can be achieved manually (for example, creating a new usergroup for the club's management and assigning moderator permissions over the forum to members of that).

The parent forum and forum grouping for new club forums is configurable.
[/surround]

[concepts
 1_key="virtual root"       1_value="Virtual roots allow you to split a Composr tree based content system (such as the download system) so it appears to have multiple databases"
 2_key="redirection page"   2_value="Allows pages to be redirected to from different zone/page combinations, either transparently, or with a redirection message"
]Concepts[/concepts]

[title="2"]See also[/title]

 - [page="_SEARCH:tut_msn"]Advanced techniques for multi-site-networks[/page]
 - [page="_SEARCH:tut_structure"]Composr site structure[/page]

{$SET,tutorial_tags,redirects_editor,cns_clubs,Structure and navigation,regular}{$SET,tutorial_add_date,Aug 2008}{$SET,tutorial_summary,A common features of the largest community sites is to have sub-communities within the larger community. See how.}[block]main_tutorial_rating[/block]
